# 段寄存器 *16 + 偏移量地址

## 实模式的内存布局

| 起始地址  | 结束地址 | 大小 |用途 |
| ------- | ------- | ------- | ------- |
| 0x000   | 0x3FF  | 1KB|中断向量表|
| 0x400   |  0x4FF | 256B |BIOS数据区|
| 0x500 | 0x7BFF |29.75KB | 可用区域|
|0x7C00 |  0x7DFF |512B  | MBR 加载区域|
|0X7E00  |  0x9FBFF |607.6KB  | 可用区域|
|0x9FC00 |  0x9FFFF |1KB   | 扩展BIOS数据区|
|0xA0000   |  0xAFFFF | 64KB   | 用于彩色显示适配器|
|0xB0000   |  0xB7FFF  | 32KB  |  用于黑白显示适配器|
|0xB8000  |   0xBFFFF  |   32KB     |用于文本显示适配器|
|0xC0000  |  0xC7FFF  |32KB    |  显示适配器BIOS|
|0xC8000  |    0xEFFFF |160KB  | 映射内存|
|0xF0000   |   0xFFFEF |64KB-16B |  系统BIOS|
|0xFFFF0  |   0xFFFFF |16B |  系统BIOS入口地址|

## 编译常用操作

nasm -f bin boot.asm -o boot.bin    将nasm转化成bin文件
dd if=hello.bin of=master.img bs=512 count=1 conv=notrunc
 将bin文件写入master.img
qemu-img convert -O vmdk master.img master.vmdk  将img转化成虚拟磁盘

## 创建硬盘镜像

bximage  -q -hd=16 -func=create -sectsize=512 -imgmode=flat master.img

## bochsrc配置文件

// configuration file generated by Bochs

plugin_ctrl: unmapped=true, biosdev=true, speaker=true, extfpuirq=true, parallel=true, serial=true, iodebug=true, pcidev=false, usb_uhci=false
config_interface: textconfig
display_library: x, options="gui_debug"
memory: host=32, guest=32
romimage: file="/usr/share/bochs/BIOS-bochs-latest", address=0x00000000, options=none
vgaromimage: file="/usr/share/bochs/VGABIOS-lgpl-latest"
boot: disk
floppy_bootsig_check: disabled=0
floppya: type=1_44

// no floppyb

ata0: enabled=true, ioaddr1=0x1f0, ioaddr2=0x3f0, irq=14
ata0-master: type=disk, path="master.img", mode=flat
ata0-slave: type=none
ata1: enabled=true, ioaddr1=0x170, ioaddr2=0x370, irq=15
ata1-master: type=none
ata1-slave: type=none
ata2: enabled=false
ata3: enabled=false
optromimage1: file=none
optromimage2: file=none
optromimage3: file=none
optromimage4: file=none
optramimage1: file=none
optramimage2: file=none
optramimage3: file=none
optramimage4: file=none
pci: enabled=1, chipset=i440fx, slot1=none, slot2=none, slot3=none, slot4=none, slot5=none
vga: extension=vbe, update_freq=5, realtime=1, ddc=builtin
cpu: count=1:1:1, ips=4000000, quantum=16, model=bx_generic, reset_on_triple_fault=1, cpuid_limit_winnt=0, ignore_bad_msrs=1, mwait_is_nop=0
cpuid: level=6, stepping=3, model=3, family=6, vendor_string="AuthenticAMD", brand_string="AMD Athlon(tm) processor"
cpuid: mmx=true, apic=xapic, simd=sse2, sse4a=false, misaligned_sse=false, sep=true
cpuid: movbe=false, adx=false, aes=false, sha=false, xsave=false, xsaveopt=false, avx_f16c=false
cpuid: avx_fma=false, bmi=0, xop=false, fma4=false, tbm=false, x86_64=true, 1g_pages=false
cpuid: pcid=false, fsgsbase=false, smep=false, smap=false, mwait=true
print_timestamps: enabled=0
debugger_log: -
magic_break: enabled=1
port_e9_hack: enabled=0
private_colormap: enabled=0
clock: sync=none, time0=local, rtc_sync=0

// no cmosimage

log: -
logprefix: %t%e%d
debug: action=ignore
info: action=report
error: action=report
panic: action=ask
keyboard: type=mf, serial_delay=250, paste_delay=100000, user_shortcut=none
mouse: type=ps2, enabled=false, toggle=ctrl+mbutton
speaker: enabled=true, mode=system
parport1: enabled=true, file=none
parport2: enabled=false
com1: enabled=true, mode=null
com2: enabled=false
com3: enabled=false
com4: enabled=false
